{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Alyssa%20Janes/Desktop/deer-intake/lib/useScanner.ts"],"sourcesContent":["'use client';\r\nimport { useEffect, useRef } from 'react';\r\n\r\n/**\r\n * useScanner - captures fast keyboard-wedge barcode scans that end with Enter.\r\n * Resets buffer if typing is slow (i.e., a human).\r\n */\r\nexport function useScanner(onScan: (code: string) => void, opts?: { resetMs?: number }) {\r\n  const buf = useRef('');\r\n  const t = useRef<ReturnType<typeof setTimeout> | null>(null);\r\n  const resetMs = opts?.resetMs ?? 150;\r\n\r\n  useEffect(() => {\r\n    const onKey = (e: KeyboardEvent) => {\r\n      if (e.key === 'Enter') {\r\n        const code = buf.current.trim();\r\n        buf.current = '';\r\n        if (code) onScan(code);\r\n        return;\r\n      }\r\n      if (e.key.length === 1) {\r\n        buf.current += e.key;\r\n        if (t.current) clearTimeout(t.current);\r\n        t.current = setTimeout(() => (buf.current = ''), resetMs);\r\n      }\r\n    };\r\n    window.addEventListener('keydown', onKey);\r\n    return () => window.removeEventListener('keydown', onKey);\r\n  }, [onScan, resetMs]);\r\n}\r\n"],"names":[],"mappings":";;;;AACA;;AADA;;AAOO,SAAS,WAAW,MAA8B,EAAE,IAA2B;;IACpF,MAAM,MAAM,IAAA,uKAAM,EAAC;IACnB,MAAM,IAAI,IAAA,uKAAM,EAAuC;QACvC;IAAhB,MAAM,UAAU,CAAA,gBAAA,iBAAA,2BAAA,KAAM,OAAO,cAAb,2BAAA,gBAAiB;IAEjC,IAAA,0KAAS;gCAAC;YACR,MAAM;8CAAQ,CAAC;oBACb,IAAI,EAAE,GAAG,KAAK,SAAS;wBACrB,MAAM,OAAO,IAAI,OAAO,CAAC,IAAI;wBAC7B,IAAI,OAAO,GAAG;wBACd,IAAI,MAAM,OAAO;wBACjB;oBACF;oBACA,IAAI,EAAE,GAAG,CAAC,MAAM,KAAK,GAAG;wBACtB,IAAI,OAAO,IAAI,EAAE,GAAG;wBACpB,IAAI,EAAE,OAAO,EAAE,aAAa,EAAE,OAAO;wBACrC,EAAE,OAAO,GAAG;0DAAW,IAAO,IAAI,OAAO,GAAG;yDAAK;oBACnD;gBACF;;YACA,OAAO,gBAAgB,CAAC,WAAW;YACnC;wCAAO,IAAM,OAAO,mBAAmB,CAAC,WAAW;;QACrD;+BAAG;QAAC;QAAQ;KAAQ;AACtB;GAtBgB","debugId":null}},
    {"offset": {"line": 55, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Alyssa%20Janes/Desktop/deer-intake/lib/api.ts"],"sourcesContent":["const BASE = '/api/gas2';\r\n\r\nexport type GetJobResp = { ok: boolean; exists: boolean; job?: any; error?: string };\r\nexport type SaveResp   = { ok: boolean; error?: string; row?: number };\r\nexport type ProgressResp = { ok: boolean; nextStatus?: 'Processing'|'Finished'|null; error?: string };\r\n\r\nexport type SearchJobsResp = {\r\n  ok: boolean;\r\n  rows: any[];\r\n  total?: number;\r\n  error?: string;\r\n  jobs?: any[];\r\n  results?: any[];\r\n  raw?: any;\r\n};\r\n\r\nasync function fetchJson(url: string, init?: RequestInit, attempts = 3, timeoutMs = 7000) {\r\n  let lastErr: any = null;\r\n  for (let i = 0; i < attempts; i++) {\r\n    const ctrl = new AbortController();\r\n    const to = setTimeout(() => ctrl.abort(), timeoutMs);\r\n    try {\r\n      const res = await fetch(url, { cache: 'no-store', ...init, signal: ctrl.signal });\r\n      clearTimeout(to);\r\n      const data = await res.json().catch(() => ({}));\r\n      if (res.ok) return data;\r\n      lastErr = (data as any)?.error || `HTTP ${res.status}`;\r\n      if ([429, 502, 503, 504].includes(res.status)) {\r\n        await new Promise(r => setTimeout(r, 250 * (i + 1)));\r\n        continue;\r\n      }\r\n      break;\r\n    } catch (e: any) {\r\n      clearTimeout(to);\r\n      lastErr = e?.name === 'AbortError' ? 'Request timed out' : (e?.message || e);\r\n      await new Promise(r => setTimeout(r, 250 * (i + 1)));\r\n    }\r\n  }\r\n  return { ok: false, error: String(lastErr || 'Network error') };\r\n}\r\n\r\nexport async function getJob(tag: string): Promise<GetJobResp> {\r\n  return fetchJson(`${BASE}/get?tag=${encodeURIComponent(tag)}`);\r\n}\r\n\r\nexport async function saveJob(job: any): Promise<SaveResp> {\r\n  return fetchJson(`${BASE}/save`, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type':'application/json' },\r\n    body: JSON.stringify({ job })\r\n  });\r\n}\r\n\r\nexport async function progress(tag: string): Promise<ProgressResp> {\r\n  return fetchJson(`${BASE}/progress`, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type':'application/json' },\r\n    body: JSON.stringify({ tag })\r\n  });\r\n}\r\n\r\nexport async function searchJobs(\r\n  opts?: string | { q?: string; status?: string; limit?: number; offset?: number }\r\n): Promise<SearchJobsResp> {\r\n  const o = typeof opts === 'string' ? { q: opts } : (opts || {});\r\n  const p = new URLSearchParams();\r\n  if (o.q) p.set('q', o.q as string);\r\n  if (typeof (o as any).status === 'string') p.set('status', (o as any).status as string);\r\n  if ((o as any).limit != null) p.set('limit', String((o as any).limit));\r\n  if (o as any && (o as any).offset != null) p.set('offset', String((o as any).offset));\r\n\r\n  const data: any = await fetchJson(`${BASE}/search?${p.toString()}`);\r\n  const rows =\r\n    Array.isArray(data?.jobs)    ? data.jobs :\r\n    Array.isArray(data?.rows)    ? data.rows :\r\n    Array.isArray(data?.results) ? data.results :\r\n    Array.isArray(data)          ? data :\r\n    [];\r\n\r\n  const ok = !!data?.ok || Array.isArray(rows);\r\n  const total = (typeof data?.total === 'number' ? data.total : rows.length) as number | undefined;\r\n\r\n  return {\r\n    ok,\r\n    rows,\r\n    total,\r\n    error: data?.error,\r\n    jobs: rows,\r\n    results: rows,\r\n    raw: data\r\n  };\r\n}\r\n\r\n\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 159, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Alyssa%20Janes/Desktop/deer-intake/app/scan/page.tsx"],"sourcesContent":["'use client';\r\nimport { useRef, useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { useScanner } from '@/lib/useScanner';\r\nimport { progress } from '@/lib/api';\r\n\r\nfunction useBeep() {\r\n  // Tiny WebAudio beeps: success & error\r\n  const ctxRef = useRef<AudioContext | null>(null);\r\n  const getCtx = () => (ctxRef.current ??= new (window.AudioContext || (window as any).webkitAudioContext)());\r\n  const play = (freq = 880, durMs = 120, type: OscillatorType = 'sine', gain = 0.04) => {\r\n    const ctx = getCtx();\r\n    const osc = ctx.createOscillator();\r\n    const g = ctx.createGain();\r\n    osc.type = type;\r\n    osc.frequency.value = freq;\r\n    g.gain.value = gain;\r\n    osc.connect(g); g.connect(ctx.destination);\r\n    const t = ctx.currentTime;\r\n    osc.start(t);\r\n    osc.stop(t + durMs / 1000);\r\n  };\r\n  return {\r\n    ok: () => { play(1046, 90, 'triangle', 0.05); setTimeout(()=>play(1318, 110, 'triangle', 0.05), 60); },\r\n    err: () => { play(220, 140, 'sawtooth', 0.06); setTimeout(()=>play(196, 160, 'sawtooth', 0.06), 70); }\r\n  };\r\n}\r\n\r\nexport default function ScanKiosk() {\r\n  const router = useRouter();\r\n  const [last, setLast] = useState<string>('');\r\n  const [status, setStatus] = useState<{ kind:'idle'|'ok'|'err'; text:string }>({ kind:'idle', text:'' });\r\n\r\n  const guardRef = useRef({ lastAt: 0, lastTag: '' });\r\n  const beeps = useBeep();\r\n\r\n  useScanner(async (rawTag) => {\r\n    const tag = String(rawTag || '').trim();\r\n    const now = Date.now();\r\n    // Debounce: ignore events within 250ms; also ignore immediate duplicate within 1000ms\r\n    if (now - guardRef.current.lastAt < 250) return;\r\n    if (tag === guardRef.current.lastTag && now - guardRef.current.lastAt < 1000) return;\r\n    guardRef.current = { lastAt: now, lastTag: tag };\r\n\r\n    setLast(tag);\r\n    setStatus({ kind:'idle', text:'' });\r\n\r\n    try {\r\n      const res = await progress(tag);\r\n      if (!res?.ok) throw new Error(res?.error || 'Could not progress');\r\n\r\n      if (res.nextStatus === 'Processing') {\r\n        setStatus({ kind:'ok', text:'Processing — opening butcher view…' });\r\n        beeps.ok();\r\n        router.push(`/butcher/intake?tag=${encodeURIComponent(tag)}`);\r\n      } else if (res.nextStatus === 'Finished') {\r\n        setStatus({ kind:'ok', text:'Marked Finished ✓' });\r\n        beeps.ok();\r\n        // Keep kiosk ready for the next scan\r\n        setTimeout(() => setStatus({ kind:'idle', text:'' }), 1000);\r\n      } else {\r\n        setStatus({ kind:'err', text:'No status change' });\r\n        beeps.err();\r\n        setTimeout(() => setStatus({ kind:'idle', text:'' }), 1000);\r\n      }\r\n    } catch (e: any) {\r\n      setStatus({ kind:'err', text: e?.message || 'Scan failed' });\r\n      beeps.err();\r\n    }\r\n  });\r\n\r\n  return (\r\n    <main className=\"scan-page\" style={{ textAlign:'center' }}>\r\n      <h1 style={{ margin:'4px 0 8px' }}>Scan a Tag</h1>\r\n      <p style={{ color:'var(--muted)', margin:'0 0 16px' }}>\r\n        Scan once to start Processing; scan again to mark Finished.\r\n      </p>\r\n\r\n      <div style={{ fontSize:56, fontWeight:900, letterSpacing:1, margin:'14px 0' }}>{last || '—'}</div>\r\n\r\n      {/* Big, color banner */}\r\n      <div\r\n        aria-live=\"polite\"\r\n        style={{\r\n          minHeight: 52,\r\n          display:'grid',\r\n          placeItems:'center',\r\n          fontWeight:800,\r\n          border:'1px solid var(--border)',\r\n          borderRadius:12,\r\n          margin:'10px auto 0',\r\n          maxWidth: 680,\r\n          padding:'10px 12px',\r\n          background:\r\n            status.kind === 'ok' ? '#ecfdf5' :\r\n            status.kind === 'err' ? '#fef2f2' : 'rgba(255,255,255,0.9)',\r\n          color:\r\n            status.kind === 'ok' ? '#065f46' :\r\n            status.kind === 'err' ? '#991b1b' : 'var(--muted)'\r\n        }}\r\n      >\r\n        {status.text || 'Ready for next scan'}\r\n      </div>\r\n    </main>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}