{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Alyssa%20Janes/Desktop/deer-intake/lib/api.ts"],"sourcesContent":["const BASE = '/api/gas2';\r\n\r\nexport type GetJobResp = { ok: boolean; exists: boolean; job?: any; error?: string };\r\nexport type SaveResp   = { ok: boolean; error?: string; row?: number };\r\nexport type ProgressResp = { ok: boolean; nextStatus?: 'Processing'|'Finished'|null; error?: string };\r\nexport type SearchJobsResp = { ok: boolean; rows: any[]; total?: number; error?: string };\r\n\r\nasync function fetchJson(url: string, init?: RequestInit, attempts = 3, timeoutMs = 7000) {\r\n  let lastErr: any = null;\r\n  for (let i = 0; i < attempts; i++) {\r\n    const ctrl = new AbortController();\r\n    const to = setTimeout(() => ctrl.abort(), timeoutMs);\r\n    try {\r\n      const res = await fetch(url, { cache: 'no-store', ...init, signal: ctrl.signal });\r\n      clearTimeout(to);\r\n      const data = await res.json().catch(() => ({}));\r\n      if (res.ok) return data;\r\n      lastErr = data?.error || `HTTP ${res.status}`;\r\n      // retry on transient\r\n      if ([429, 502, 503, 504].includes(res.status)) { await new Promise(r => setTimeout(r, 250*(i+1))); continue; }\r\n      break;\r\n    } catch (e:any) {\r\n      clearTimeout(to);\r\n      lastErr = e?.name === 'AbortError' ? 'Request timed out' : (e?.message || e);\r\n      await new Promise(r => setTimeout(r, 250*(i+1)));\r\n    }\r\n  }\r\n  return { ok: false, error: String(lastErr || 'Network error') };\r\n}\r\n\r\nexport async function getJob(tag: string): Promise<GetJobResp> {\r\n  return fetchJson(`${BASE}/get?tag=${encodeURIComponent(tag)}`);\r\n}\r\n\r\nexport async function saveJob(job: any): Promise<SaveResp> {\r\n  return fetchJson(`${BASE}/save`, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type':'application/json' },\r\n    body: JSON.stringify({ job })\r\n  });\r\n}\r\n\r\nexport async function progress(tag: string): Promise<ProgressResp> {\r\n  return fetchJson(`${BASE}/progress`, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type':'application/json' },\r\n    body: JSON.stringify({ tag })\r\n  });\r\n}\r\n\r\nexport async function searchJobs(\r\n  opts?: string | { q?: string; status?: string; limit?: number; offset?: number }\r\n): Promise<SearchJobsResp> {\r\n  const o = typeof opts === 'string' ? { q: opts } : (opts || {});\r\n  const p = new URLSearchParams();\r\n  if (o.q) p.set('q', o.q);\r\n  if (o.status) p.set('status', o.status);\r\n  if (o.limit != null) p.set('limit', String(o.limit));\r\n  if (o.offset != null) p.set('offset', String(o.offset));\r\n  return fetchJson(`${BASE}/search?${p.toString()}`);\r\n}\r\n\r\n"],"names":[],"mappings":";;;;;;;;;;AAAA,MAAM,OAAO;AAOb,eAAe,UAAU,GAAW,EAAE,IAAkB,EAAE,WAAW,CAAC,EAAE,YAAY,IAAI;IACtF,IAAI,UAAe;IACnB,IAAK,IAAI,IAAI,GAAG,IAAI,UAAU,IAAK;QACjC,MAAM,OAAO,IAAI;QACjB,MAAM,KAAK,WAAW,IAAM,KAAK,KAAK,IAAI;QAC1C,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,KAAK;gBAAE,OAAO;gBAAY,GAAG,IAAI;gBAAE,QAAQ,KAAK,MAAM;YAAC;YAC/E,aAAa;YACb,MAAM,OAAO,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;YAC7C,IAAI,IAAI,EAAE,EAAE,OAAO;YACnB,UAAU,MAAM,SAAS,CAAC,KAAK,EAAE,IAAI,MAAM,EAAE;YAC7C,qBAAqB;YACrB,IAAI;gBAAC;gBAAK;gBAAK;gBAAK;aAAI,CAAC,QAAQ,CAAC,IAAI,MAAM,GAAG;gBAAE,MAAM,IAAI,QAAQ,CAAA,IAAK,WAAW,GAAG,MAAI,CAAC,IAAE,CAAC;gBAAK;YAAU;YAC7G;QACF,EAAE,OAAO,GAAO;YACd,aAAa;YACb,UAAU,GAAG,SAAS,eAAe,sBAAuB,GAAG,WAAW;YAC1E,MAAM,IAAI,QAAQ,CAAA,IAAK,WAAW,GAAG,MAAI,CAAC,IAAE,CAAC;QAC/C;IACF;IACA,OAAO;QAAE,IAAI;QAAO,OAAO,OAAO,WAAW;IAAiB;AAChE;AAEO,eAAe,OAAO,GAAW;IACtC,OAAO,UAAU,GAAG,KAAK,SAAS,EAAE,mBAAmB,MAAM;AAC/D;AAEO,eAAe,QAAQ,GAAQ;IACpC,OAAO,UAAU,GAAG,KAAK,KAAK,CAAC,EAAE;QAC/B,QAAQ;QACR,SAAS;YAAE,gBAAe;QAAmB;QAC7C,MAAM,KAAK,SAAS,CAAC;YAAE;QAAI;IAC7B;AACF;AAEO,eAAe,SAAS,GAAW;IACxC,OAAO,UAAU,GAAG,KAAK,SAAS,CAAC,EAAE;QACnC,QAAQ;QACR,SAAS;YAAE,gBAAe;QAAmB;QAC7C,MAAM,KAAK,SAAS,CAAC;YAAE;QAAI;IAC7B;AACF;AAEO,eAAe,WACpB,IAAgF;IAEhF,MAAM,IAAI,OAAO,SAAS,WAAW;QAAE,GAAG;IAAK,IAAK,QAAQ,CAAC;IAC7D,MAAM,IAAI,IAAI;IACd,IAAI,EAAE,CAAC,EAAE,EAAE,GAAG,CAAC,KAAK,EAAE,CAAC;IACvB,IAAI,EAAE,MAAM,EAAE,EAAE,GAAG,CAAC,UAAU,EAAE,MAAM;IACtC,IAAI,EAAE,KAAK,IAAI,MAAM,EAAE,GAAG,CAAC,SAAS,OAAO,EAAE,KAAK;IAClD,IAAI,EAAE,MAAM,IAAI,MAAM,EAAE,GAAG,CAAC,UAAU,OAAO,EAAE,MAAM;IACrD,OAAO,UAAU,GAAG,KAAK,QAAQ,EAAE,EAAE,QAAQ,IAAI;AACnD","debugId":null}},
    {"offset": {"line": 92, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Alyssa%20Janes/Desktop/deer-intake/app/admin/health/page.tsx"],"sourcesContent":["'use client';\r\nimport { useEffect, useState } from 'react';\r\nimport { getJob, progress, saveJob, searchJobs } from '@/lib/api';\r\n\r\ntype Row = { label: string; ok?: boolean; msg?: string; route?: string };\r\n\r\nexport default function HealthPage(){\r\n  const [rows, setRows] = useState<Row[]>([]);\r\n  const [env, setEnv] = useState<{ NEXT_PUBLIC_GAS_BASE?: string; GAS_BASE?: string }>({});\r\n\r\n  useEffect(() => {\r\n    setEnv({\r\n      NEXT_PUBLIC_GAS_BASE: process.env.NEXT_PUBLIC_GAS_BASE,\r\n      GAS_BASE: process.env.GAS_BASE as any\r\n    });\r\n\r\n    (async () => {\r\n      const out: Row[] = [];\r\n      // Search ping\r\n      try {\r\n        const r = await searchJobs('1');\r\n        out.push({ label:'GET /search', ok: !!r.ok, msg: r.ok?'ok':'fail' });\r\n      } catch (e:any){ out.push({ label:'GET /search', ok:false, msg:e?.message }); }\r\n\r\n      // Get\r\n      try {\r\n        const r = await getJob('1');\r\n        out.push({ label:'GET /get?tag=1', ok: !!r.ok, msg: r.ok? (r.exists?'exists':'not found') : (r.error||'fail') });\r\n      } catch (e:any){ out.push({ label:'GET /get', ok:false, msg:e?.message }); }\r\n\r\n      // Save (safe dummy)\r\n      try {\r\n        const r = await saveJob({ tag:'HEALTH-CHECK', status:'Dropped Off', dropoff:'2025-01-01', customer:'Health', phone:'0000000', email:'x@x', address:'-', city:'-', state:'-', zip:'-' , county:'-', sex:'Doe', processType:'Standard Processing' });\r\n        out.push({ label:'POST /save', ok: !!r.ok, msg: r.ok?'ok':(r.error||'fail') });\r\n      } catch (e:any){ out.push({ label:'POST /save', ok:false, msg:e?.message }); }\r\n\r\n      // Progress (harmless if tag missing)\r\n      try {\r\n        const r = await progress('HEALTH-CHECK');\r\n        out.push({ label:'POST /progress', ok: !!r.ok, msg: r.ok?(r.nextStatus||'ok'):(r.error||'fail') });\r\n      } catch (e:any){ out.push({ label:'POST /progress', ok:false, msg:e?.message }); }\r\n\r\n      setRows(out);\r\n    })();\r\n  }, []);\r\n\r\n  return (\r\n    <main className=\"page-wrap\">\r\n      <h2>Admin Health</h2>\r\n      <div className=\"card\" style={{margin:'8px 0'}}>\r\n        <div className=\"muted\" style={{marginBottom:8}}>Env</div>\r\n        <div><strong>NEXT_PUBLIC_GAS_BASE:</strong> {env.NEXT_PUBLIC_GAS_BASE || <em>(unset)</em>}</div>\r\n        <div><strong>GAS_BASE:</strong> {env.GAS_BASE || <em>(unset)</em>}</div>\r\n      </div>\r\n\r\n      <table className=\"tbl\" style={{marginTop:12}}>\r\n        <thead><tr><th>Check</th><th>Status</th></tr></thead>\r\n        <tbody>\r\n        {rows.map((r,i)=>(\r\n          <tr key={i}>\r\n            <td>{r.label}</td>\r\n            <td style={{color:r.ok?'#065f46':'#b91c1c', fontWeight:700}}>\r\n              {r.ok ? 'OK' : 'FAIL'} {r.msg? `â€” ${r.msg}`:''}\r\n            </td>\r\n          </tr>\r\n        ))}\r\n        </tbody>\r\n      </table>\r\n    </main>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":"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","debugId":null}}]
}