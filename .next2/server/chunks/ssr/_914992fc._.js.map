{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Alyssa%20Janes/Desktop/deer-intake/lib/useScanner.ts"],"sourcesContent":["'use client';\r\nimport { useEffect, useRef } from 'react';\r\n\r\n/**\r\n * useScanner - captures fast keyboard-wedge barcode scans that end with Enter.\r\n * Resets buffer if typing is slow (i.e., a human).\r\n */\r\nexport function useScanner(onScan: (code: string) => void, opts?: { resetMs?: number }) {\r\n  const buf = useRef('');\r\n  const t = useRef<ReturnType<typeof setTimeout> | null>(null);\r\n  const resetMs = opts?.resetMs ?? 150;\r\n\r\n  useEffect(() => {\r\n    const onKey = (e: KeyboardEvent) => {\r\n      if (e.key === 'Enter') {\r\n        const code = buf.current.trim();\r\n        buf.current = '';\r\n        if (code) onScan(code);\r\n        return;\r\n      }\r\n      if (e.key.length === 1) {\r\n        buf.current += e.key;\r\n        if (t.current) clearTimeout(t.current);\r\n        t.current = setTimeout(() => (buf.current = ''), resetMs);\r\n      }\r\n    };\r\n    window.addEventListener('keydown', onKey);\r\n    return () => window.removeEventListener('keydown', onKey);\r\n  }, [onScan, resetMs]);\r\n}\r\n"],"names":[],"mappings":";;;;AACA;AADA;;AAOO,SAAS,WAAW,MAA8B,EAAE,IAA2B;IACpF,MAAM,MAAM,IAAA,+MAAM,EAAC;IACnB,MAAM,IAAI,IAAA,+MAAM,EAAuC;IACvD,MAAM,UAAU,MAAM,WAAW;IAEjC,IAAA,kNAAS,EAAC;QACR,MAAM,QAAQ,CAAC;YACb,IAAI,EAAE,GAAG,KAAK,SAAS;gBACrB,MAAM,OAAO,IAAI,OAAO,CAAC,IAAI;gBAC7B,IAAI,OAAO,GAAG;gBACd,IAAI,MAAM,OAAO;gBACjB;YACF;YACA,IAAI,EAAE,GAAG,CAAC,MAAM,KAAK,GAAG;gBACtB,IAAI,OAAO,IAAI,EAAE,GAAG;gBACpB,IAAI,EAAE,OAAO,EAAE,aAAa,EAAE,OAAO;gBACrC,EAAE,OAAO,GAAG,WAAW,IAAO,IAAI,OAAO,GAAG,IAAK;YACnD;QACF;QACA,OAAO,gBAAgB,CAAC,WAAW;QACnC,OAAO,IAAM,OAAO,mBAAmB,CAAC,WAAW;IACrD,GAAG;QAAC;QAAQ;KAAQ;AACtB","debugId":null}},
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Alyssa%20Janes/Desktop/deer-intake/lib/api.ts"],"sourcesContent":["const BASE = '/api/gas2';\r\n\r\nexport type GetJobResp = { ok: boolean; exists: boolean; job?: any; error?: string };\r\nexport type SaveResp   = { ok: boolean; error?: string; row?: number };\r\nexport type ProgressResp = { ok: boolean; nextStatus?: 'Processing'|'Finished'|null; error?: string };\r\nexport type SearchJobsResp = { ok: boolean; rows: any[]; total?: number; error?: string };\r\n\r\nasync function fetchJson(url: string, init?: RequestInit, attempts = 3, timeoutMs = 7000) {\r\n  let lastErr: any = null;\r\n  for (let i = 0; i < attempts; i++) {\r\n    const ctrl = new AbortController();\r\n    const to = setTimeout(() => ctrl.abort(), timeoutMs);\r\n    try {\r\n      const res = await fetch(url, { cache: 'no-store', ...init, signal: ctrl.signal });\r\n      clearTimeout(to);\r\n      const data = await res.json().catch(() => ({}));\r\n      if (res.ok) return data;\r\n      lastErr = data?.error || `HTTP ${res.status}`;\r\n      // retry on transient\r\n      if ([429, 502, 503, 504].includes(res.status)) { await new Promise(r => setTimeout(r, 250*(i+1))); continue; }\r\n      break;\r\n    } catch (e:any) {\r\n      clearTimeout(to);\r\n      lastErr = e?.name === 'AbortError' ? 'Request timed out' : (e?.message || e);\r\n      await new Promise(r => setTimeout(r, 250*(i+1)));\r\n    }\r\n  }\r\n  return { ok: false, error: String(lastErr || 'Network error') };\r\n}\r\n\r\nexport async function getJob(tag: string): Promise<GetJobResp> {\r\n  return fetchJson(`${BASE}/get?tag=${encodeURIComponent(tag)}`);\r\n}\r\n\r\nexport async function saveJob(job: any): Promise<SaveResp> {\r\n  return fetchJson(`${BASE}/save`, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type':'application/json' },\r\n    body: JSON.stringify({ job })\r\n  });\r\n}\r\n\r\nexport async function progress(tag: string): Promise<ProgressResp> {\r\n  return fetchJson(`${BASE}/progress`, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type':'application/json' },\r\n    body: JSON.stringify({ tag })\r\n  });\r\n}\r\n\r\nexport async function searchJobs(\r\n  opts?: string | { q?: string; status?: string; limit?: number; offset?: number }\r\n): Promise<SearchJobsResp> {\r\n  const o = typeof opts === 'string' ? { q: opts } : (opts || {});\r\n  const p = new URLSearchParams();\r\n  if (o.q) p.set('q', o.q);\r\n  if (o.status) p.set('status', o.status);\r\n  if (o.limit != null) p.set('limit', String(o.limit));\r\n  if (o.offset != null) p.set('offset', String(o.offset));\r\n  return fetchJson(`${BASE}/search?${p.toString()}`);\r\n}\r\n\r\n"],"names":[],"mappings":";;;;;;;;;;AAAA,MAAM,OAAO;AAOb,eAAe,UAAU,GAAW,EAAE,IAAkB,EAAE,WAAW,CAAC,EAAE,YAAY,IAAI;IACtF,IAAI,UAAe;IACnB,IAAK,IAAI,IAAI,GAAG,IAAI,UAAU,IAAK;QACjC,MAAM,OAAO,IAAI;QACjB,MAAM,KAAK,WAAW,IAAM,KAAK,KAAK,IAAI;QAC1C,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,KAAK;gBAAE,OAAO;gBAAY,GAAG,IAAI;gBAAE,QAAQ,KAAK,MAAM;YAAC;YAC/E,aAAa;YACb,MAAM,OAAO,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;YAC7C,IAAI,IAAI,EAAE,EAAE,OAAO;YACnB,UAAU,MAAM,SAAS,CAAC,KAAK,EAAE,IAAI,MAAM,EAAE;YAC7C,qBAAqB;YACrB,IAAI;gBAAC;gBAAK;gBAAK;gBAAK;aAAI,CAAC,QAAQ,CAAC,IAAI,MAAM,GAAG;gBAAE,MAAM,IAAI,QAAQ,CAAA,IAAK,WAAW,GAAG,MAAI,CAAC,IAAE,CAAC;gBAAK;YAAU;YAC7G;QACF,EAAE,OAAO,GAAO;YACd,aAAa;YACb,UAAU,GAAG,SAAS,eAAe,sBAAuB,GAAG,WAAW;YAC1E,MAAM,IAAI,QAAQ,CAAA,IAAK,WAAW,GAAG,MAAI,CAAC,IAAE,CAAC;QAC/C;IACF;IACA,OAAO;QAAE,IAAI;QAAO,OAAO,OAAO,WAAW;IAAiB;AAChE;AAEO,eAAe,OAAO,GAAW;IACtC,OAAO,UAAU,GAAG,KAAK,SAAS,EAAE,mBAAmB,MAAM;AAC/D;AAEO,eAAe,QAAQ,GAAQ;IACpC,OAAO,UAAU,GAAG,KAAK,KAAK,CAAC,EAAE;QAC/B,QAAQ;QACR,SAAS;YAAE,gBAAe;QAAmB;QAC7C,MAAM,KAAK,SAAS,CAAC;YAAE;QAAI;IAC7B;AACF;AAEO,eAAe,SAAS,GAAW;IACxC,OAAO,UAAU,GAAG,KAAK,SAAS,CAAC,EAAE;QACnC,QAAQ;QACR,SAAS;YAAE,gBAAe;QAAmB;QAC7C,MAAM,KAAK,SAAS,CAAC;YAAE;QAAI;IAC7B;AACF;AAEO,eAAe,WACpB,IAAgF;IAEhF,MAAM,IAAI,OAAO,SAAS,WAAW;QAAE,GAAG;IAAK,IAAK,QAAQ,CAAC;IAC7D,MAAM,IAAI,IAAI;IACd,IAAI,EAAE,CAAC,EAAE,EAAE,GAAG,CAAC,KAAK,EAAE,CAAC;IACvB,IAAI,EAAE,MAAM,EAAE,EAAE,GAAG,CAAC,UAAU,EAAE,MAAM;IACtC,IAAI,EAAE,KAAK,IAAI,MAAM,EAAE,GAAG,CAAC,SAAS,OAAO,EAAE,KAAK;IAClD,IAAI,EAAE,MAAM,IAAI,MAAM,EAAE,GAAG,CAAC,UAAU,OAAO,EAAE,MAAM;IACrD,OAAO,UAAU,GAAG,KAAK,QAAQ,EAAE,EAAE,QAAQ,IAAI;AACnD","debugId":null}},
    {"offset": {"line": 128, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Alyssa%20Janes/Desktop/deer-intake/app/components/Toast.tsx"],"sourcesContent":["'use client';\r\nimport { createContext, useCallback, useContext, useMemo, useState } from 'react';\r\n\r\ntype Toast = { id: number; text: string; tone?: 'ok'|'err'|'info' };\r\ntype Ctx = { toast: (text: string, tone?: Toast['tone']) => void };\r\n\r\nconst ToastCtx = createContext<Ctx>({ toast: () => {} });\r\n\r\nexport function ToastProvider({ children }: { children: React.ReactNode }) {\r\n  const [items, setItems] = useState<Toast[]>([]);\r\n  const toast = useCallback((text: string, tone: Toast['tone']='info') => {\r\n    const id = Date.now() + Math.random();\r\n    setItems(p => [...p, { id, text, tone }]);\r\n    setTimeout(() => setItems(p => p.filter(t => t.id !== id)), 2500);\r\n  }, []);\r\n  const value = useMemo(() => ({ toast }), [toast]);\r\n\r\n  return (\r\n    <ToastCtx.Provider value={value}>\r\n      {children}\r\n      <div className=\"toasts\">\r\n        {items.map(t => (\r\n          <div key={t.id} className={`toast ${t.tone==='ok'?'ok': t.tone==='err'?'err':''}`}>\r\n            {t.text}\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </ToastCtx.Provider>\r\n  );\r\n}\r\n\r\nexport function useToast(){ return useContext(ToastCtx); }\r\n"],"names":[],"mappings":";;;;;;;AACA;AADA;;;AAMA,MAAM,yBAAW,IAAA,sNAAa,EAAM;IAAE,OAAO,KAAO;AAAE;AAE/C,SAAS,cAAc,EAAE,QAAQ,EAAiC;IACvE,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAU,EAAE;IAC9C,MAAM,QAAQ,IAAA,oNAAW,EAAC,CAAC,MAAc,OAAoB,MAAM;QACjE,MAAM,KAAK,KAAK,GAAG,KAAK,KAAK,MAAM;QACnC,SAAS,CAAA,IAAK;mBAAI;gBAAG;oBAAE;oBAAI;oBAAM;gBAAK;aAAE;QACxC,WAAW,IAAM,SAAS,CAAA,IAAK,EAAE,MAAM,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK,MAAM;IAC9D,GAAG,EAAE;IACL,MAAM,QAAQ,IAAA,gNAAO,EAAC,IAAM,CAAC;YAAE;QAAM,CAAC,GAAG;QAAC;KAAM;IAEhD,qBACE,8OAAC,SAAS,QAAQ;QAAC,OAAO;;YACvB;0BACD,8OAAC;gBAAI,WAAU;0BACZ,MAAM,GAAG,CAAC,CAAA,kBACT,8OAAC;wBAAe,WAAW,CAAC,MAAM,EAAE,EAAE,IAAI,KAAG,OAAK,OAAM,EAAE,IAAI,KAAG,QAAM,QAAM,IAAI;kCAC9E,EAAE,IAAI;uBADC,EAAE,EAAE;;;;;;;;;;;;;;;;AAOxB;AAEO,SAAS;IAAY,OAAO,IAAA,mNAAU,EAAC;AAAW","debugId":null}},
    {"offset": {"line": 194, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Alyssa%20Janes/Desktop/deer-intake/app/scan/page.tsx"],"sourcesContent":["'use client';\r\nimport { useEffect, useMemo, useState } from 'react';\r\nimport { useRouter, useSearchParams } from 'next/navigation';\r\nimport { useScanner } from '@/lib/useScanner';\r\nimport { progress } from '@/lib/api';\r\nimport { useToast } from '@/app/components/Toast';\r\n\r\nexport default function ScanKiosk() {\r\n  const sp = useSearchParams();\r\n  const kiosk = useMemo(() => sp.get('kiosk') === '1', [sp]);\r\n  const router = useRouter();\r\n  const { toast } = useToast();\r\n\r\n  const [last, setLast] = useState<string>('');\r\n  const [status, setStatus] = useState<string>('');\r\n\r\n  // Enter/exit kiosk styles + fullscreen\r\n  useEffect(() => {\r\n    if (!kiosk) return;\r\n    document.body.classList.add('kiosk');\r\n    (async () => {\r\n      try { if (!document.fullscreenElement) await document.documentElement.requestFullscreen(); } catch {}\r\n      // @ts-ignore\r\n      try { if (navigator.wakeLock?.request) { /* @ts-ignore */ await navigator.wakeLock.request('screen'); } } catch {}\r\n    })();\r\n    return () => document.body.classList.remove('kiosk');\r\n  }, [kiosk]);\r\n\r\n  useScanner(async (tag) => {\r\n    setLast(tag);\r\n    setStatus('');\r\n    try {\r\n      const res = await progress(tag);\r\n      if (!res?.ok) throw new Error(res?.error || 'Could not progress');\r\n      if (res.nextStatus === 'Processing') {\r\n        toast(`Tag ${tag} → Processing`, 'ok');\r\n        router.push(`/butcher/intake?tag=${encodeURIComponent(tag)}`);\r\n      } else if (res.nextStatus === 'Finished') {\r\n        toast(`Tag ${tag} → Finished`, 'ok');\r\n        setStatus('Marked Finished ✓');\r\n        setTimeout(()=> setStatus(''), 1200);\r\n      } else {\r\n        setStatus('No change');\r\n      }\r\n    } catch (e:any) {\r\n      setStatus(e?.message || 'Scan failed');\r\n      toast('Scan failed', 'err');\r\n    }\r\n  });\r\n\r\n  return (\r\n    <main className=\"page-wrap\" style={{textAlign:'center'}}>\r\n      <h1 style={{margin:'4px 0 8px'}}>Scan a Tag</h1>\r\n      <p className=\"muted\" style={{margin:'0 0 16px'}}>\r\n        {kiosk ? 'Kiosk mode: TV-ready, opens the butcher view automatically.' : 'This screen will open the butcher view automatically.'}\r\n      </p>\r\n      <div style={{fontSize: kiosk?64:48, fontWeight:900, letterSpacing:1, margin:'12px 0'}}>{last || '—'}</div>\r\n      <div style={{height:20, fontWeight:700, color: status.includes('✓') ? '#065f46' : '#b91c1c'}}>{status}</div>\r\n    </main>\r\n  );\r\n}\r\n\r\n\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;AACA;AALA;;;;;;;AAOe,SAAS;IACtB,MAAM,KAAK,IAAA,qJAAe;IAC1B,MAAM,QAAQ,IAAA,gNAAO,EAAC,IAAM,GAAG,GAAG,CAAC,aAAa,KAAK;QAAC;KAAG;IACzD,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,EAAE,KAAK,EAAE,GAAG,IAAA,uIAAQ;IAE1B,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAS;IACzC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAAS;IAE7C,uCAAuC;IACvC,IAAA,kNAAS,EAAC;QACR,IAAI,CAAC,OAAO;QACZ,SAAS,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC;QAC5B,CAAC;YACC,IAAI;gBAAE,IAAI,CAAC,SAAS,iBAAiB,EAAE,MAAM,SAAS,eAAe,CAAC,iBAAiB;YAAI,EAAE,OAAM,CAAC;YACpG,aAAa;YACb,IAAI;gBAAE,IAAI,UAAU,QAAQ,EAAE,SAAS;oBAAmB,MAAM,UAAU,QAAQ,CAAC,OAAO,CAAC;gBAAW;YAAE,EAAE,OAAM,CAAC;QACnH,CAAC;QACD,OAAO,IAAM,SAAS,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;IAC9C,GAAG;QAAC;KAAM;IAEV,IAAA,+HAAU,EAAC,OAAO;QAChB,QAAQ;QACR,UAAU;QACV,IAAI;YACF,MAAM,MAAM,MAAM,IAAA,sHAAQ,EAAC;YAC3B,IAAI,CAAC,KAAK,IAAI,MAAM,IAAI,MAAM,KAAK,SAAS;YAC5C,IAAI,IAAI,UAAU,KAAK,cAAc;gBACnC,MAAM,CAAC,IAAI,EAAE,IAAI,aAAa,CAAC,EAAE;gBACjC,OAAO,IAAI,CAAC,CAAC,oBAAoB,EAAE,mBAAmB,MAAM;YAC9D,OAAO,IAAI,IAAI,UAAU,KAAK,YAAY;gBACxC,MAAM,CAAC,IAAI,EAAE,IAAI,WAAW,CAAC,EAAE;gBAC/B,UAAU;gBACV,WAAW,IAAK,UAAU,KAAK;YACjC,OAAO;gBACL,UAAU;YACZ;QACF,EAAE,OAAO,GAAO;YACd,UAAU,GAAG,WAAW;YACxB,MAAM,eAAe;QACvB;IACF;IAEA,qBACE,8OAAC;QAAK,WAAU;QAAY,OAAO;YAAC,WAAU;QAAQ;;0BACpD,8OAAC;gBAAG,OAAO;oBAAC,QAAO;gBAAW;0BAAG;;;;;;0BACjC,8OAAC;gBAAE,WAAU;gBAAQ,OAAO;oBAAC,QAAO;gBAAU;0BAC3C,QAAQ,gEAAgE;;;;;;0BAE3E,8OAAC;gBAAI,OAAO;oBAAC,UAAU,QAAM,KAAG;oBAAI,YAAW;oBAAK,eAAc;oBAAG,QAAO;gBAAQ;0BAAI,QAAQ;;;;;;0BAChG,8OAAC;gBAAI,OAAO;oBAAC,QAAO;oBAAI,YAAW;oBAAK,OAAO,OAAO,QAAQ,CAAC,OAAO,YAAY;gBAAS;0BAAI;;;;;;;;;;;;AAGrG","debugId":null}}]
}